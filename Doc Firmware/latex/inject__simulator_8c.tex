\doxysection{C\+:/\+Users/\+User/\+Desktop/filtro\+\_\+activo\+\_\+armonicos\+\_\+corriente/\+Sources/\+Core/\+Src/active\+\_\+current\+\_\+harmonics\+\_\+filter/subsystems/inject\+\_\+simulator/inject\+\_\+simulator.c File Reference}
\hypertarget{inject__simulator_8c}{}\label{inject__simulator_8c}\index{C:/Users/User/Desktop/filtro\_activo\_armonicos\_corriente/Sources/Core/Src/active\_current\_harmonics\_filter/subsystems/inject\_simulator/inject\_simulator.c@{C:/Users/User/Desktop/filtro\_activo\_armonicos\_corriente/Sources/Core/Src/active\_current\_harmonics\_filter/subsystems/inject\_simulator/inject\_simulator.c}}


Current injection simulator.  


{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$malloc.\+h$>$}\newline
{\ttfamily \#include "{}main.\+h"{}}\newline
{\ttfamily \#include "{}inject\+\_\+simulator.\+h"{}}\newline
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531}{inject\+\_\+state\+\_\+t}} \{ \mbox{\hyperlink{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531a9870be6506f384e407a78d75b2f4f9d7}{STATE\+\_\+\+INJECTION\+\_\+\+DISABLED}}
, \mbox{\hyperlink{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531a8697619ba7f5abf9d8a66e3e6497163c}{STATE\+\_\+\+INJECTION\+\_\+\+RUNNING}}
, \mbox{\hyperlink{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531a955d9f2892f2f6428bc81d5e74c22ff0}{STATE\+\_\+\+INJECTION\+\_\+\+WAITING\+\_\+\+CYCLE}}
 \}
\begin{DoxyCompactList}\small\item\em Enumeration of current injection states. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{inject__simulator_8c_a94a9c4e267870841972897eaf60e1546}\label{inject__simulator_8c_a94a9c4e267870841972897eaf60e1546} 
void {\bfseries inject\+\_\+simulator\+\_\+init} ()
\begin{DoxyCompactList}\small\item\em Initializes the API. \end{DoxyCompactList}\item 
\Hypertarget{inject__simulator_8c_a68ad9d61a900c548673acaf7d1cfee7c}\label{inject__simulator_8c_a68ad9d61a900c548673acaf7d1cfee7c} 
void {\bfseries app\+\_\+inject\+\_\+simulator\+\_\+state\+\_\+machine} ()
\begin{DoxyCompactList}\small\item\em Manages the start of a new transmission. This function should run in the main loop. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{inject__simulator_8c_a1a48ec8c3d96e3cb522b3b3c9fcb2600}{inject\+\_\+simulator\+\_\+set\+\_\+waveform}} (\mbox{\hyperlink{structcycle__t}{cycle\+\_\+t}} cycle)
\begin{DoxyCompactList}\small\item\em Sets the current waveform to inject on each new cycle detection. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{inject__simulator_8c_a6208557d4cf3f6ac4e9cf0461e9f4d43}{inject\+\_\+simulator\+\_\+set\+\_\+enable}} (bool enable)
\begin{DoxyCompactList}\small\item\em Enable or disable the injection. \end{DoxyCompactList}\item 
\Hypertarget{inject__simulator_8c_ad34e07c17ebf5818992b73fe37f5c4e7}\label{inject__simulator_8c_ad34e07c17ebf5818992b73fe37f5c4e7} 
void {\bfseries inject\+\_\+simulator\+\_\+cycle\+\_\+\+IRQHandler} ()
\begin{DoxyCompactList}\small\item\em Notifies the API that a new cycle has started This function should be called whenever a new cycle is detected on the power line. \end{DoxyCompactList}\item 
\Hypertarget{inject__simulator_8c_a7fb5bfe41c10e9e35bd851b32feb4a87}\label{inject__simulator_8c_a7fb5bfe41c10e9e35bd851b32feb4a87} 
void {\bfseries inject\+\_\+simulator\+\_\+timer\+\_\+\+IRQHandler} ()
\begin{DoxyCompactList}\small\item\em Notifies the API that the current value must be updated This function should be called in timer interrupt callback. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{inject__simulator_8c_a40a0d1383beda58531dfda6218720e45}\label{inject__simulator_8c_a40a0d1383beda58531dfda6218720e45} 
DAC\+\_\+\+Handle\+Type\+Def {\bfseries hdac}
\begin{DoxyCompactList}\small\item\em ADC handle for the DAC output. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Current injection simulator. 

\begin{DoxyAuthor}{Author}
Nicol√°s Almaraz 
\end{DoxyAuthor}
This API is responsible for simulating what would be a current injection into the power line. Each time it receives the notification that a new cycle has started, it injects the pre-\/loaded waveform via DAC. This allows the waveform calculated by the microcontroller to be measured with an oscilloscope at the DAC output. 

\doxysubsection{Enumeration Type Documentation}
\Hypertarget{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531}\index{inject\_simulator.c@{inject\_simulator.c}!inject\_state\_t@{inject\_state\_t}}
\index{inject\_state\_t@{inject\_state\_t}!inject\_simulator.c@{inject\_simulator.c}}
\doxysubsubsection{\texorpdfstring{inject\_state\_t}{inject\_state\_t}}
{\footnotesize\ttfamily \label{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531} 
enum \mbox{\hyperlink{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531}{inject\+\_\+state\+\_\+t}}}



Enumeration of current injection states. 

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{STATE\_INJECTION\_DISABLED@{STATE\_INJECTION\_DISABLED}!inject\_simulator.c@{inject\_simulator.c}}\index{inject\_simulator.c@{inject\_simulator.c}!STATE\_INJECTION\_DISABLED@{STATE\_INJECTION\_DISABLED}}}\Hypertarget{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531a9870be6506f384e407a78d75b2f4f9d7}\label{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531} 
STATE\+\_\+\+INJECTION\+\_\+\+DISABLED&Injection is disabled. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{STATE\_INJECTION\_RUNNING@{STATE\_INJECTION\_RUNNING}!inject\_simulator.c@{inject\_simulator.c}}\index{inject\_simulator.c@{inject\_simulator.c}!STATE\_INJECTION\_RUNNING@{STATE\_INJECTION\_RUNNING}}}\Hypertarget{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531a8697619ba7f5abf9d8a66e3e6497163c}\label{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531} 
STATE\+\_\+\+INJECTION\+\_\+\+RUNNING&Injection is running and actively updating the DAC. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{STATE\_INJECTION\_WAITING\_CYCLE@{STATE\_INJECTION\_WAITING\_CYCLE}!inject\_simulator.c@{inject\_simulator.c}}\index{inject\_simulator.c@{inject\_simulator.c}!STATE\_INJECTION\_WAITING\_CYCLE@{STATE\_INJECTION\_WAITING\_CYCLE}}}\Hypertarget{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531a955d9f2892f2f6428bc81d5e74c22ff0}\label{inject__simulator_8c_aa601d5006dd399f9fe1df59c6ee7f531} 
STATE\+\_\+\+INJECTION\+\_\+\+WAITING\+\_\+\+CYCLE&Waiting for a new cycle to start injection. \\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\Hypertarget{inject__simulator_8c_a6208557d4cf3f6ac4e9cf0461e9f4d43}\index{inject\_simulator.c@{inject\_simulator.c}!inject\_simulator\_set\_enable@{inject\_simulator\_set\_enable}}
\index{inject\_simulator\_set\_enable@{inject\_simulator\_set\_enable}!inject\_simulator.c@{inject\_simulator.c}}
\doxysubsubsection{\texorpdfstring{inject\_simulator\_set\_enable()}{inject\_simulator\_set\_enable()}}
{\footnotesize\ttfamily \label{inject__simulator_8c_a6208557d4cf3f6ac4e9cf0461e9f4d43} 
void inject\+\_\+simulator\+\_\+set\+\_\+enable (\begin{DoxyParamCaption}\item[{bool}]{enable}{}\end{DoxyParamCaption})}



Enable or disable the injection. 


\begin{DoxyParams}{Parameters}
{\em enable} & (true\+: Enable) -- (false\+: Disable) \\
\hline
\end{DoxyParams}
\Hypertarget{inject__simulator_8c_a1a48ec8c3d96e3cb522b3b3c9fcb2600}\index{inject\_simulator.c@{inject\_simulator.c}!inject\_simulator\_set\_waveform@{inject\_simulator\_set\_waveform}}
\index{inject\_simulator\_set\_waveform@{inject\_simulator\_set\_waveform}!inject\_simulator.c@{inject\_simulator.c}}
\doxysubsubsection{\texorpdfstring{inject\_simulator\_set\_waveform()}{inject\_simulator\_set\_waveform()}}
{\footnotesize\ttfamily \label{inject__simulator_8c_a1a48ec8c3d96e3cb522b3b3c9fcb2600} 
void inject\+\_\+simulator\+\_\+set\+\_\+waveform (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcycle__t}{cycle\+\_\+t}}}]{cycle}{}\end{DoxyParamCaption})}



Sets the current waveform to inject on each new cycle detection. 


\begin{DoxyParams}{Parameters}
{\em buffer} & with the cycle to inject \\
\hline
\end{DoxyParams}
